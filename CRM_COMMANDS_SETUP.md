# Настройка команд CRM в BotFather

## Список команд для BotFather

К сожалению, Telegram Bot API не поддерживает настройку команд только для топиков. Команды будут видны везде, но работать они будут только в CRM-топиках.

### Как настроить команды:

1. Откройте чат с [@BotFather](https://t.me/BotFather)
2. Отправьте команду `/setcommands`
3. Выберите вашего бота
4. Скопируйте и отправьте следующий список команд:

```
start - Запустить бота
info - (CRM) Информация о пользователе
trial - (CRM) Выдать пробный ключ
payment - (CRM) Создать счет на оплату
key - (CRM) Выдать ключ с параметрами
notification - (CRM) Отправить уведомление
```

## Описание CRM команд

### `/info` - Информация о пользователе
**Работает только в CRM-топиках**

Показывает полную информацию о пользователе:
- Основные данные (ID, имя, username, дата регистрации)
- Финансовая статистика (заказы, потраченная сумма)
- Статистика по ключам (всего, активных, истекших)
- Статистика по трафику
- Статус пробного периода
- **Кликабельный список ключей с пагинацией (5 на страницу)**

При клике на ключ показывается:
- Детальная информация о ключе
- Статистика трафика
- Кнопка "Добавить дни" для продления

### `/trial` - Выдать пробный ключ
**Работает только в CRM-топиках**

Выдает пользователю пробный ключ на 24 часа.
- Автоматически отправляется пользователю в личные сообщения
- Уведомление в CRM-топик об успешной выдаче

### `/payment` - Создать счет на оплату
**Работает только в CRM-топиках**

Создает счет на произвольную сумму для пользователя.

**Процесс:**
1. Админ вводит `/payment` в топике
2. Бот запрашивает сумму
3. Админ вводит сумму (целое число в рублях)
4. Сообщение админа с суммой удаляется
5. Счет отправляется пользователю в личные сообщения
6. Подтверждение в CRM-топик
7. При успешной оплате - уведомление в CRM-топик

### `/key` - Выдать ключ с параметрами
**Работает только в CRM-топиках**

Выдает пользователю ключ с произвольными параметрами (страна и срок).

**Процесс:**
1. Админ вводит `/key` в топике
2. Бот показывает кнопки выбора страны
3. Админ выбирает страну
4. Бот запрашивает количество дней
5. Админ вводит количество дней (целое число)
6. Сообщение админа с числом удаляется
7. Ключ создается и отправляется пользователю в личные сообщения
8. Подтверждение в CRM-топик с деталями ключа

### `/notification` - Отправить уведомление
**Работает только в CRM-топиках**

Отправляет произвольное текстовое сообщение пользователю.

**Процесс:**
1. Админ вводит `/notification` в топике
2. Бот запрашивает текст сообщения
3. Админ вводит текст (поддерживается HTML-разметка)
4. Сообщение админа с текстом удаляется
5. Сообщение отправляется пользователю
6. Подтверждение в CRM-топик

**Поддерживаемая HTML-разметка:**
- `<b>жирный</b>` - **жирный**
- `<i>курсив</i>` - *курсив*
- `<code>код</code>` - `код`
- `<a href="URL">ссылка</a>` - [ссылка](URL)

## Примечания

- Все CRM-команды работают **только в топиках CRM-группы**
- При попытке использовать команду вне CRM-топика - команда игнорируется
- Сообщения админа с вводимыми данными автоматически удаляются для чистоты топика
- Все действия логируются и отправляются подтверждения в топик

